<h2><%= @tree.common_name %></h2>

<% if @tree.scientific_name -%>
<p><i><%= @tree.scientific_name %></i></p>
<%- end %>

<div class="mb-3"><%= sanitize @tree.content %></div>

<% if @tree.openstreetmap_node.present? -%>
<p><a href="<%= "https://www.openstreetmap.org/node/#{@tree.openstreetmap_node}" %>">View this tree's location on OpenStreetMap</a>.</p>
<%- end %>

<% if @tree.images.attached? -%>
<h3>Pictures</h3>

<div class="row row-cols-2 row-cols-lg-3">
<% @tree.images.each do |image| %>
    <div class="col mb-4">
        <div class="card">
            <%= link_to(image_tag(image.variant(apply: { thumbnail: '320x300^', gravity: 'center', extent: '320x300' }), class: "card-img-top"), rails_blob_path(image))%>
            <div class="card-body">
                <p class="card-text"><%= image.filename %></p>
                <% if @tree.user == current_user -%>
                <%= link_to 'Remove', tree_attachment_path(@tree, image.id), method: :delete, class: "btn btn-sm btn-outline-danger", data: { confirm: "Are you sure you want to remove this image?" } %>
                <%- end %>
            </div>
        </div>
    </div>
<% end %>
</div>
<%- end %>

<p><i>Added by <%= @tree.user.display_name %>. Last updated <%= time_ago_in_words @tree.updated_at %> ago.</i></p>

<% if @tree.user == current_user -%>
<%= link_to 'Edit', edit_tree_path(@tree), class: 'btn btn-secondary mr-2' %>
<%= link_to "Remove", tree_path(@tree), method: :delete, class: "btn btn-danger", data: { confirm: "Are you sure you want to remove this?" } %>
<%- end %>
